<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}

{% block title %}
<title>{{restaurants_db.restaurant_name}}</title>
{% endblock title %}



{% block css %}
<link rel="stylesheet" href="{% static 'css/StoreDetails.css' %}">
<link rel="stylesheet" href="clearfix.css">
{% endblock css %}

{% block content %}
<div class = backcoler>
  <br>
  <p class="shopname">{{restaurants_db.restaurant_name}}&nbsp;
    {% if restaurants_db.support_allergy == True %}
      <img src="{% static 'img/Corresponding.png' %}" width="180" height="100">
    {% endif %}
  </p>
  <br>
  <!--店舗イメージ画像-->
  <div class="storeImg">
    <img src="{% static 'img/cafe.jpg' %}" width="350" height="300"><br><br>
    <img src="{% static 'img/waffle.jpg' %}" width="350" height="300"><br><br>
    <img src="{% static 'img/coffe.jpg' %}" width="350" height="300"><br><br>
  </div>
  <!--店舗イメージ画像ここまで-->

  <!--アレルゲン表示とタグ-->
    <div class="allergenList">
      <p class="boldText">お店のひとこと</p>
      <p class="allerInfo">{{ restaurants_db.explanation }}</p>
      <p class="boldText">アレルギーに対する取り組み</p>
      <p class="allerInfo">{{restaurants_db.restaurant_allergy}}</p>

         <!--アレルゲンアイコン-->
      <div class="allergenImg">
        {%for aller in restaurants_db.allergy_tag.all %}
          <img src="{{ aller.image.url }}" width="80" height="80">
        {% endfor %}
      </div>

    <div class="allergenTag">
      <h5>タグ：{{restaurants_db.tags }}</h5>
    </div>
  </div>
  <!--アレルゲンタグここまで-->

    <!--店舗基本情報のテーブル-->
  <div class="informationTable">
    <p class="tableTitle">店舗基本情報</p>
    <table class="inlineRight">
      <tr>
        <th>店名</th>
        <td>{{restaurants_db.restaurant_name}}</td>
      </tr>
      <tr>
        <th>同じ器具で調理しているアレルゲン</th>
        <td>{{restaurants_db.restaurant_allergy}}</td>
      </tr>
      <tr>
        <th>定休日</th>
        <td>{{restaurants_db.time}}</td>
      </tr>
      <tr>
        <th>住所</th>
        <!--<td>〒{{restaurants_db.postal_code}}<br>{{restaurants_db.address}}</td>-->
        <td>
          <div class="addressCode">
          <p class="address">〒{{restaurants_db.postal_code}}<br>
          {{restaurants_db.address}}<br>
          {{restaurants_db.transportation}}</p>
  
        <iframe 
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3280.221249650056!2d135.19094770084797!3d34.699599090688814!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60008edd1fe54845%3A0xb872547b0f538bea!2z56We5oi46Zu75a2Q5bCC6ZaA5a2m5qCh!5e0!3m2!1sja!2sjp!4v1641875305141!5m2!1sja!2sjp"
          width="400" height="200" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div></td>
      </tr>
      <tr>
        <th>座席数</th>
        <td>{{restaurants_db.seat}} ({{restaurants_db.reserved}})</td>
      </tr>
      <tr>
        <th>支払い方法</th>
        <td>{{restaurants_db.payment}}</td>
      </tr>
      <tr>
        <th>電話番号</th>
        <td>{{restaurants_db.tel}}</td>
      </tr>
    </table>
  </div>
  <!--店舗基本情報ここまで-->

  <!--メニューここにいれたい-->
  <!--プロトタイプ4枚目(メニューリスト)-->
  {% for menu in menu_db %}
    {% if menu.store_id == restaurants_db.pk %}
      <div class="menuList">
        <p class="boldText">メニュー</p>
        <img src={{menu.image.url}} width="300" height="300">
        <div class="menuInfo">
          <p class="menuPrice">￥{{menu.price}}</p>
          <div class="menuName">{{menu.name}}</div>
          <p class="menuAllergen">使用アレルゲン　<span>{{menu.allergy}}</span></p>
          <p class="menuComment">{{menu.remarks}}</p>
        </div>
      </div>
    {% endif %}
  {% endfor %}
  <!--メニューここまで-->

  <!--評価-->
  <div class="clearfix">
    <div class="rating">
      <p class="boldText">レビュー</p>
      <hr>
      <br>
      {% if review_db != None %}
        {%for a in review_db%}
        <br>
        <div class="reviews">   <!--個人のレビュー-->
         
          <p class="reviewsName">{{ a.user.user }}:{{ a.title }}</p><!--名前+タイトル-->
          <p class="reviewsComments">{{ a.review }}</p><!--コメント-->
          <span class="reviewsStar">お店の評価　　　　</span>

          <span class="star-mini">
            {% for _ in ''|center:a.evaluation %}<!--星の数-->
              ★
            {%endfor%}
          {{a.evaluation}}.0</span><br>

          <span class="reviewsStar">アレルギー対応の評価</span>

          <span class="star-mini">
            {% for _ in ''|center:a.allergy_evaluation %}<!--星の数-->
              ★
            {%endfor%}
          {{a.allergy_evaluation}}.0</span><!--とりあえず★にしてる--><br>
      
        </div>    <!--個人のレビューここまで-->
        {% endfor %}
        <br>
        <hr>
      <span class="rating-name">アレルギー対応の評価</span>
      <span class="star">
      {% for _ in ''|center:count2.allergy_evaluation__avg %}<!--星の数-->
        ★
      {%endfor%}
      {{count2.allergy_evaluation__avg}}.0</span>
      <br>
      <span class="rating-name">トータルの評価　　　</span>
      <span class="star">
      {% for _ in ''|center:count1.evaluation__avg %}<!--星の数-->
        ★
      {%endfor%}
      {{count1.evaluation__avg}}.0</span>
      
      {% else %}
        <h3>まだレビューは投稿されていません</h3>
      {% endif %}
    </div>  <!--rating-->
  </div>
  <!--評価ここまで-->
  <div class="customerQA">    <!--カスタマーQ＆A-->
    <p class="boldText">カスタマーQ&A</p>
    <hr>
    <br>
    {% if question_db != None %}
      {%for ques in question_db%}
        <div class="customerQuestion">
          <p class="questionName">質問者:{{ ques.user.user }}</p><!--IDか名前か-->
          <p class="question">{{ ques.question }}</p><!--質問-->
        </div>
        {% for ans in answer_db %}
          {% if ans.question_id == ques.pk %}
          
            <div class="customerAnswer">
              <p class="AnswerName">回答者:{{ ans.user.user }}</p><!--IDか名前か-->
              <p class="Answer">{{ ans.answer }}</p><!--回答-->
            </div>
          {% endif %}
        {% endfor %}
      {% endfor %}
      <hr>
      <br>
      <a href="{% url 'CustomerAnswerForm' %}" class="btn btn--orange  btn--shadow">回答したい方はこちら</a><!--まとめてもOK-->
      <a href="{% url 'CustomerQuestionForm' %}" class="btn btn--oranges  btn--shadows">質問したい方はこちら</a>
    {% else %}
      <h3>カスタマーQ&Aは投稿されていません</h3>
      <a href="{% url 'CustomerQuestionForm' %}">質問したい方はこちら</a><!--質問・回答したい方はみたいに-->
    {%endif%}
  </div>
  <br>
</div>
{% endblock content %}

{% block footer %}
{% endblock footer %}